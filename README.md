## Directory Structure

- **`estimation.py`**  
  Code for training the model, scaling data, performing clustering, and saving required parameters for deployment (e.g., cluster medians, scaler, and KMeans model).

- **`harness.py`**  
  A single-entry script that combines the pipeline components to take input data (input_csv), run predictions using the pre-trained model, and save the output predictions (output_csv).

- **`prediction.py`**  
  Code to load saved parameters and models to make predictions on new input data.
  
- **`cluster_medians.csv`**  
  A CSV file containing cluster-wise medians for imputing missing values during prediction.

- **`kmeans_model.pkl`**  
  A pre-trained KMeans clustering model saved as a pickle file.

- **`scaler.pkl`**  
  A saved StandardScaler object for scaling features during prediction.

- **`model_xgb.json`**  
  A pre-trained XGBoost model saved in JSON format.

- **`poetry.lock`**  
  A lock file generated by Poetry to ensure consistent dependency management across environments.

- **`pyproject.toml`**  
  A configuration file for managing project dependencies and environment settings using Poetry.

## Code Changes
The estimation and prediction modules were updated to ensure that the models and parameters are pre-computed and saved during training. In the estimation module, the KMeans clustering model, the StandardScaler for feature scaling, and the cluster medians for imputing missing values were calculated and saved as external files (kmeans_model.pkl, scaler.pkl, and cluster_medians.csv, respectively). These files capture the learned parameters and clusters during training and make them reusable during prediction without recalculating from the test data.

In the prediction module, these pre-saved artifacts are loaded and used to preprocess the new input data. Missing values are imputed using the precomputed cluster medians, features are scaled using the pre-trained StandardScaler, and clustering labels are assigned using the pre-trained KMeans model. These changes ensure that no information from the test data is used to learn new parameters. Additionally, the pre-trained XGBoost model is loaded in JSON format (model_xgb.json). 

